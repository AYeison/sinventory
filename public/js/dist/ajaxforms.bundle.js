(()=>{"use strict";document.addEventListener("DOMContentLoaded",function(){const e=function(){function e(e,t,n,o,s){const i=document.createElement("form"),a=document.createElement("button"),c=document.createElement("input"),r=e.id.replace(/^category-/,""),l=document.createElement("input");a.type="submit",a.innerHTML="<span>"+t+"</span>",a.innerHTML+='<span class="icon is-small">',a.innerHTML+='<i class="fas fa-times"></i>',a.innerHTML+="</span>",a.className={delete:"delete-button button is-danger is-outlined",edit:"edit-button button is-info is-outlined"}[o],c.type="hidden",c.value=r,c.name="category_id",l.type="hidden",l.value=n,l.name="action",i.appendChild(a),i.appendChild(c),i.appendChild(l),i.action="./php/category.php",i.method="POST",i.className="form-btn-dlt ajaxform",i.style.position="absolute",i.style.top="-0.5em",i.style.right="-0.5em",e.appendChild(i),s.dataset.mode="deactive-dlt",s.textContent="Cancelar"}return{transform_input_slug:e=>{const t=e.closest("#category_new");if(!t)return!1;const n=t.querySelector("#slug"),o=document.querySelector(".preview-slug");if(o&&n){const t=e.value.trim().toLowerCase().replace(/\s+/g,"-");o.textContent=t,n.value=o.textContent}},card_down_toggle:e=>{let t=e.closest(".card");if(t){let e=t.querySelector(".card-content");if(e){e.style.transition="max-height 0.3s ease",e.style.overflow="hidden";let t=e.querySelector(".card-text");t&&(t.style.transition="opacity 0.3s ease"),e.classList.contains("hidden")?(e.classList.remove("hidden"),e.style.maxHeight="0px",e.offsetWidth,e.style.maxHeight=e.scrollHeight+"px",t&&(t.style.opacity="0",t.offsetWidth,t.style.opacity="1"),e.addEventListener("transitionend",function t(){e.style.maxHeight="",e.removeEventListener("transitionend",t)})):(e.style.maxHeight=e.scrollHeight+"px",e.offsetWidth,e.style.maxHeight="0px",t&&(t.style.opacity="1",t.offsetWidth,t.style.opacity="0"),e.addEventListener("transitionend",function t(){e.classList.add("hidden"),e.removeEventListener("transitionend",t)})),e.classList.toggle("active")}}},dissable_button:e=>{const t=document.querySelector(`button[type="submit"][data-type="${e}"]`);t&&(t.disabled=!0,t.classList.add("is-loading"),setTimeout(()=>{t.classList.remove("is-loading")},2e3))},return_button:()=>{const e=document.getElementById("cat_message"),t=e.dataset.type||"waiting",n=e.dataset.stMessage||"Esperando por una solicitud...",o=document.getElementById("cat_cancel"),s=document.querySelector(`button[type="submit"][data-type="${t}"]`);s&&o&&(s.disabled=!1,s.classList.remove("is-loading"),e.innerHTML=n)},delete_categories:()=>{document.addEventListener("click",function(t){let n=t.target;if(!n.matches("#delete-category"))return;t.preventDefault();let o=n.dataset.mode;const s=document.getElementById("categories-list");if(s&&s.firstChild){const t=s.querySelectorAll(".column");t&&t.forEach(function(t){if("active-dlt"===o)e(t,"Delete","delete_category","delete",n);else if("deactive-dlt"===o){const e=t.querySelector(".form-btn-dlt");e&&(e.remove(),n.dataset.mode="active-dlt",n.textContent="Delete")}})}})},edit_categories:()=>{document.addEventListener("click",function(t){let n=t.target;if(!n.matches("#edit-category"))return;t.preventDefault();let o=n.dataset.mode;const s=document.getElementById("categories-list");if(s&&s.firstChild){const t=s.querySelectorAll(".column");t&&t.forEach(function(t){if("active-dlt"===o)e(t,"Edit","edit_category","edit",n);else if("deactive-dlt"===o){const e=t.querySelector(".form-btn-dlt");e&&(e.remove(),n.dataset.mode="active-dlt",n.textContent="Edit")}})}})}}}();const t={new_category:function(t){const n=document.getElementById("cat_message"),o=t.html;n.innerHTML=o,n.dataset.type=t.action,e.dissable_button(t.action)},save_category:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{last_category:n}=e,{form:o=null}=t,s=document.getElementById("error-notification"),i=document.getElementById("categories-list"),a=document.createElement("div");s.innerHTML=e.message,s.style.display="block",a.id="category-"+n.categoria_id,a.className="column is-one-quarter",a.style.position="relative",a.innerHTML=`\n                <div class="card">\n                    <div class="card-content">\n                        <p class="title is-5">${n.categoria_name}</p>\n                        <p class="subtitle is-6">${n.categoria_description}</p>\n                    </div>\n                </div>\n            `,i.appendChild(a),o&&o.reset()},register:function(e){window.location.href="success?message="+e.message},login:function(e){window.location.href="home"},logout:function(e){window.location.href="login?message="+e.message},none:function(e,t){throw new Error("Action not recognized: "+e.action)},delete_category:function(e){const{category_id:t}=e,n=document.querySelector("#category-"+t);console.log("Category deleted:",t);const o=document.getElementById("cat_noty_message");o.innerHTML=`\n            <div class="notification is-info is-light fade-in" style="position:fixed;top:1rem;right:1rem;z-index:1000;transition:opacity 0.5s;">\n            Category ${t} deleted successfully.\n            <button class="delete"></button>\n            </div>\n        `,o.dataset.type="delete_category",n&&(n.style.transition="opacity 0.3s",setTimeout(()=>{n.style.opacity="0",setTimeout(()=>{n.remove()},500)},300));const s=o.querySelector(".notification");s&&(s.style.opacity="0",setTimeout(()=>{s.style.opacity="1"},10),setTimeout(()=>{s.style.opacity="0",setTimeout(()=>{o.innerHTML=""},500)},3e3));const i=o.querySelector(".delete");i&&i.addEventListener("click",()=>{s?(s.style.opacity="0",setTimeout(()=>{o.innerHTML=""},500)):o.innerHTML=""})}};this.addEventListener("submit",function(e){if(e.target.matches(".ajaxform")){e.preventDefault();const n=e.target,o=new FormData(n),s=n.getAttribute("action"),i=n.getAttribute("method").toUpperCase(),a=new Headers;fetch(s,{method:i,headers:a,mode:"cors",cache:"no-cache",body:o}).then(e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);return e.text()}).then(e=>{try{const o=JSON.parse(e);if(console.log(o),"success"===o.status)t[o.action](o,{form:n});else if("error"===o.status){const e=document.getElementById("error-notification"),t=o.hasOwnProperty("row")?o.row:"";e.innerHTML=o.message+"<br>"+t,e.style.display="block"}}catch(t){throw console.error("Error parsing response:",t),new Error("Invalid JSON response: "+e)}}).catch(e=>{console.error("Error:",e)})}});const n=document.getElementById("password-input"),o=document.getElementById("toggle-password");if(o&&n){const e=o.querySelector("i");o.addEventListener("click",function(t){"password"===n.type?(n.type="text",e.classList.remove("fa-eye"),e.classList.add("fa-eye-slash")):(n.type="password",e.classList.remove("fa-eye-slash"),e.classList.add("fa-eye"))})}document.addEventListener("click",t=>{t.target.matches("#cat_cancel")&&e.return_button()})})})();
//# sourceMappingURL=ajaxforms.bundle.js.map