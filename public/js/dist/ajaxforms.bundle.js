(()=>{"use strict";document.addEventListener("DOMContentLoaded",function(){const e={transform_input_slug:function(e){const t=e.closest("#category_new");if(!t)return!1;const n=t.querySelector("#slug"),s=document.querySelector(".preview-slug");if(s&&n){const t=e.value.trim().toLowerCase().replace(/\s+/g,"-");s.textContent=t,n.value=s.textContent}},card_down_toggle:function(e){let t=e.closest(".card");if(t){let e=t.querySelector(".card-content");if(e){e.style.transition="max-height 0.3s ease",e.style.overflow="hidden";let t=e.querySelector(".card-text");t&&(t.style.transition="opacity 0.3s ease"),e.classList.contains("hidden")?(e.classList.remove("hidden"),e.style.maxHeight="0px",e.offsetWidth,e.style.maxHeight=e.scrollHeight+"px",t&&(t.style.opacity="0",t.offsetWidth,t.style.opacity="1"),e.addEventListener("transitionend",function t(){e.style.maxHeight="",e.removeEventListener("transitionend",t)})):(e.style.maxHeight=e.scrollHeight+"px",e.offsetWidth,e.style.maxHeight="0px",t&&(t.style.opacity="1",t.offsetWidth,t.style.opacity="0"),e.addEventListener("transitionend",function t(){e.classList.add("hidden"),e.removeEventListener("transitionend",t)})),e.classList.toggle("active")}}},dissable_button:function(e){const t=document.querySelector(`button[type="submit"][data-type="${e}"]`);t&&(t.disabled=!0,t.classList.add("is-loading"),setTimeout(()=>{t.classList.remove("is-loading")},2e3))},return_button:function(){const e=document.getElementById("cat_message"),t=e.dataset.type||"waiting",n=e.dataset.stMessage||"Esperando por una solicitud...",s=document.getElementById("cat_cancel"),o=document.querySelector(`button[type="submit"][data-type="${t}"]`);o&&s&&(o.disabled=!1,o.classList.remove("is-loading"),e.innerHTML=n)},delete_categories:function(){const e=document.getElementById("delete-category");e.addEventListener("click",function(t){t.preventDefault();let n=this.dataset.mode;const s=document.getElementById("categories-list");if(s&&s.firstChild){const t=s.querySelectorAll(".column");t&&t.forEach(function(t){if("active-dlt"===n){const n=document.createElement("form"),s=document.createElement("button"),o=document.createElement("input"),a=t.id.replace(/^category-/,""),i=document.createElement("input");s.type="submit",s.innerHTML="<span>Delete</span>",s.innerHTML+='<span class="icon is-small">',s.innerHTML+='<i class="fas fa-times"></i>',s.innerHTML+="</span>",s.className="delete-button button is-danger is-outlined",o.type="hidden",o.value=a,o.name="category_id",i.type="hidden",i.value="delete_category",i.name="action",n.appendChild(s),n.appendChild(o),n.appendChild(i),n.action="./php/category.php",n.method="POST",n.className="form-btn-dlt ajaxform",n.style.position="absolute",n.style.top="-0.5em",n.style.right="-0.5em",t.appendChild(n),e.dataset.mode="deactive-dlt",e.textContent="Cancelar"}else if("deactive-dlt"===n){const n=t.querySelector(".form-btn-dlt");n&&(n.remove(),e.dataset.mode="active-dlt",e.textContent="Delete")}})}})}};const t={new_category:function(t){const n=document.getElementById("cat_message"),s=t.html;n.innerHTML=s,n.dataset.type=t.action,e.dissable_button(t.action)},save_category:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const{last_category:n}=e,{form:s=null}=t,o=document.getElementById("error-notification"),a=document.getElementById("categories-list"),i=document.createElement("div");o.innerHTML=e.message,o.style.display="block",i.id=n.categoria_id,i.className="column is-one-quarter",i.style.position="relative",i.innerHTML=`\n                <div class="card">\n                    <div class="card-content">\n                        <p class="title is-5">${n.categoria_name}</p>\n                        <p class="subtitle is-6">${n.categoria_description}</p>\n                    </div>\n                </div>\n            `,a.appendChild(i),s&&s.reset()},register:function(e){window.location.href="success?message="+e.message},login:function(e){window.location.href="home"},logout:function(e){window.location.href="login?message="+e.message},none:function(e,t){throw new Error("Action not recognized: "+e.action)}};this.addEventListener("submit",function(e){if(e.target.matches(".ajaxform")){e.preventDefault();const n=e.target,s=new FormData(n),o=n.getAttribute("action"),a=n.getAttribute("method").toUpperCase(),i=new Headers;fetch(o,{method:a,headers:i,mode:"cors",cache:"no-cache",body:s}).then(e=>{if(!e.ok)throw new Error("Network response was not ok "+e.statusText);return e.text()}).then(e=>{try{const s=JSON.parse(e);if(console.log(s),"success"===s.status)t[s.action](s,{form:n});else if("error"===s.status){const e=document.getElementById("error-notification"),t=s.hasOwnProperty("row")?s.row:"";e.innerHTML=s.message+"<br>"+t,e.style.display="block"}}catch(t){throw console.error("Error parsing response:",t),new Error("Invalid JSON response: "+e)}}).catch(e=>{console.error("Error:",e)})}});const n=document.getElementById("password-input"),s=document.getElementById("toggle-password");if(s&&n){const e=s.querySelector("i");s.addEventListener("click",function(t){"password"===n.type?(n.type="text",e.classList.remove("fa-eye"),e.classList.add("fa-eye-slash")):(n.type="password",e.classList.remove("fa-eye-slash"),e.classList.add("fa-eye"))})}document.addEventListener("click",t=>{t.target.matches("#cat_cancel")&&e.return_button()})})})();
//# sourceMappingURL=ajaxforms.bundle.js.map